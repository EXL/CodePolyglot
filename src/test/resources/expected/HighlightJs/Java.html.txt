<table class="code-table"><tr id="line-1"><td class="table-line l-table"><a href="#line-1">1</a></td><td class="code-line l-code"><span class="hljs-keyword">package</span> ru.exlmoto.code.controller;
</td></tr><tr id="line-2"><td class="table-line d-table"><a href="#line-2">2</a></td><td class="code-line d-code">
</td></tr><tr id="line-3"><td class="table-line l-table"><a href="#line-3">3</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;
</td></tr><tr id="line-4"><td class="table-line d-table"><a href="#line-4">4</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
</td></tr><tr id="line-5"><td class="table-line l-table"><a href="#line-5">5</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.node.ObjectNode;
</td></tr><tr id="line-6"><td class="table-line d-table"><a href="#line-6">6</a></td><td class="code-line d-code">
</td></tr><tr id="line-7"><td class="table-line l-table"><a href="#line-7">7</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> org.slf4j.Logger;
</td></tr><tr id="line-8"><td class="table-line d-table"><a href="#line-8">8</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;
</td></tr><tr id="line-9"><td class="table-line l-table"><a href="#line-9">9</a></td><td class="code-line l-code">
</td></tr><tr id="line-10"><td class="table-line d-table"><a href="#line-10"><strong>10</strong></a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;
</td></tr><tr id="line-11"><td class="table-line l-table"><a href="#line-11">11</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
</td></tr><tr id="line-12"><td class="table-line d-table"><a href="#line-12">12</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;
</td></tr><tr id="line-13"><td class="table-line l-table"><a href="#line-13">13</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;
</td></tr><tr id="line-14"><td class="table-line d-table"><a href="#line-14">14</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
</td></tr><tr id="line-15"><td class="table-line l-table"><a href="#line-15">15</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
</td></tr><tr id="line-16"><td class="table-line d-table"><a href="#line-16">16</a></td><td class="code-line d-code">
</td></tr><tr id="line-17"><td class="table-line l-table"><a href="#line-17">17</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.configuration.CodeConfiguration;
</td></tr><tr id="line-18"><td class="table-line d-table"><a href="#line-18">18</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.controller.enumeration.Skin;
</td></tr><tr id="line-19"><td class="table-line l-table"><a href="#line-19">19</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.entity.CodeEntity;
</td></tr><tr id="line-20"><td class="table-line d-table"><a href="#line-20"><strong>20</strong></a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.helper.ResourceHelper;
</td></tr><tr id="line-21"><td class="table-line l-table"><a href="#line-21">21</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.helper.UtilityHelper;
</td></tr><tr id="line-22"><td class="table-line d-table"><a href="#line-22">22</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.highlight.HighlightService;
</td></tr><tr id="line-23"><td class="table-line l-table"><a href="#line-23">23</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.highlight.enumeration.Mode;
</td></tr><tr id="line-24"><td class="table-line d-table"><a href="#line-24">24</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> ru.exlmoto.code.service.DatabaseService;
</td></tr><tr id="line-25"><td class="table-line l-table"><a href="#line-25">25</a></td><td class="code-line l-code">
</td></tr><tr id="line-26"><td class="table-line d-table"><a href="#line-26">26</a></td><td class="code-line d-code"><span class="hljs-keyword">import</span> java.io.InputStream;
</td></tr><tr id="line-27"><td class="table-line l-table"><a href="#line-27">27</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> java.io.UncheckedIOException;
</td></tr><tr id="line-28"><td class="table-line d-table"><a href="#line-28">28</a></td><td class="code-line d-code">
</td></tr><tr id="line-29"><td class="table-line l-table"><a href="#line-29">29</a></td><td class="code-line l-code"><span class="hljs-keyword">import</span> java.util.Scanner;
</td></tr><tr id="line-30"><td class="table-line d-table"><a href="#line-30"><strong>30</strong></a></td><td class="code-line d-code">
</td></tr><tr id="line-31"><td class="table-line l-table"><a href="#line-31">31</a></td><td class="code-line l-code"><span class="hljs-meta">@RestController</span>
</td></tr><tr id="line-32"><td class="table-line d-table"><a href="#line-32">32</a></td><td class="code-line d-code"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApiController</span> </span>{
</td></tr><tr id="line-33"><td class="table-line l-table"><a href="#line-33">33</a></td><td class="code-line l-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Logger log = LoggerFactory.getLogger(ApiController.class);
</td></tr><tr id="line-34"><td class="table-line d-table"><a href="#line-34">34</a></td><td class="code-line d-code">
</td></tr><tr id="line-35"><td class="table-line l-table"><a href="#line-35">35</a></td><td class="code-line l-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CodeConfiguration config;
</td></tr><tr id="line-36"><td class="table-line d-table"><a href="#line-36">36</a></td><td class="code-line d-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DatabaseService database;
</td></tr><tr id="line-37"><td class="table-line l-table"><a href="#line-37">37</a></td><td class="code-line l-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> HighlightService highlight;
</td></tr><tr id="line-38"><td class="table-line d-table"><a href="#line-38">38</a></td><td class="code-line d-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ResourceHelper resource;
</td></tr><tr id="line-39"><td class="table-line l-table"><a href="#line-39">39</a></td><td class="code-line l-code">	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UtilityHelper util;
</td></tr><tr id="line-40"><td class="table-line d-table"><a href="#line-40"><strong>40</strong></a></td><td class="code-line d-code">
</td></tr><tr id="line-41"><td class="table-line l-table"><a href="#line-41">41</a></td><td class="code-line l-code">	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiController</span><span class="hljs-params">(CodeConfiguration config,</span></span>
</td></tr><tr id="line-42"><td class="table-line d-table"><a href="#line-42">42</a></td><td class="code-line d-code"><span class="hljs-function"><span class="hljs-params">	                     DatabaseService database,</span></span>
</td></tr><tr id="line-43"><td class="table-line l-table"><a href="#line-43">43</a></td><td class="code-line l-code"><span class="hljs-function"><span class="hljs-params">	                     HighlightService highlight,</span></span>
</td></tr><tr id="line-44"><td class="table-line d-table"><a href="#line-44">44</a></td><td class="code-line d-code"><span class="hljs-function"><span class="hljs-params">	                     ResourceHelper resource,</span></span>
</td></tr><tr id="line-45"><td class="table-line l-table"><a href="#line-45">45</a></td><td class="code-line l-code"><span class="hljs-function"><span class="hljs-params">	                     UtilityHelper util)</span> </span>{
</td></tr><tr id="line-46"><td class="table-line d-table"><a href="#line-46">46</a></td><td class="code-line d-code">		<span class="hljs-keyword">this</span>.config = config;
</td></tr><tr id="line-47"><td class="table-line l-table"><a href="#line-47">47</a></td><td class="code-line l-code">		<span class="hljs-keyword">this</span>.database = database;
</td></tr><tr id="line-48"><td class="table-line d-table"><a href="#line-48">48</a></td><td class="code-line d-code">		<span class="hljs-keyword">this</span>.highlight = highlight;
</td></tr><tr id="line-49"><td class="table-line l-table"><a href="#line-49">49</a></td><td class="code-line l-code">		<span class="hljs-keyword">this</span>.resource = resource;
</td></tr><tr id="line-50"><td class="table-line d-table"><a href="#line-50"><strong>50</strong></a></td><td class="code-line d-code">		<span class="hljs-keyword">this</span>.util = util;
</td></tr><tr id="line-51"><td class="table-line l-table"><a href="#line-51">51</a></td><td class="code-line l-code">	}
</td></tr><tr id="line-52"><td class="table-line d-table"><a href="#line-52">52</a></td><td class="code-line d-code">
</td></tr><tr id="line-53"><td class="table-line l-table"><a href="#line-53">53</a></td><td class="code-line l-code">	<span class="hljs-meta">@GetMapping(path = &quot;/api/raw/{id}&quot;, produces = &quot;text/plain;charset=UTF-8&quot;)</span>
</td></tr><tr id="line-54"><td class="table-line d-table"><a href="#line-54">54</a></td><td class="code-line d-code">	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">raw</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(name = &quot;id&quot;)</span> String id)</span> </span>{
</td></tr><tr id="line-55"><td class="table-line l-table"><a href="#line-55">55</a></td><td class="code-line l-code">		<span class="hljs-keyword">return</span> util.getLong(id).flatMap(database::getCodeSnippet).map(CodeEntity::getCodeRaw).orElse(
</td></tr><tr id="line-56"><td class="table-line d-table"><a href="#line-56">56</a></td><td class="code-line d-code">			<span class="hljs-string">&quot;Error: Cannot get code snippet with &#x27;&quot;</span> + id + <span class="hljs-string">&quot;&#x27; id.&quot;</span>
</td></tr><tr id="line-57"><td class="table-line l-table"><a href="#line-57">57</a></td><td class="code-line l-code">		);
</td></tr><tr id="line-58"><td class="table-line d-table"><a href="#line-58">58</a></td><td class="code-line d-code">	}
</td></tr><tr id="line-59"><td class="table-line l-table"><a href="#line-59">59</a></td><td class="code-line l-code">
</td></tr><tr id="line-60"><td class="table-line d-table"><a href="#line-60"><strong>60</strong></a></td><td class="code-line d-code">	<span class="hljs-comment">/*</span>
</td></tr><tr id="line-61"><td class="table-line l-table"><a href="#line-61">61</a></td><td class="code-line l-code"><span class="hljs-comment">	 * Highlight API usage examples:</span>
</td></tr><tr id="line-62"><td class="table-line d-table"><a href="#line-62">62</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat file.txt | curl --data-binary @- &quot;https://code.exlmoto.ru/api/&quot;</span>
</td></tr><tr id="line-63"><td class="table-line l-table"><a href="#line-63">63</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml&quot;</span>
</td></tr><tr id="line-64"><td class="table-line d-table"><a href="#line-64">64</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat src.java | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=java&quot;</span>
</td></tr><tr id="line-65"><td class="table-line l-table"><a href="#line-65">65</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines&quot;</span>
</td></tr><tr id="line-66"><td class="table-line d-table"><a href="#line-66">66</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15&quot;</span>
</td></tr><tr id="line-67"><td class="table-line l-table"><a href="#line-67">67</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15,20&quot;</span>
</td></tr><tr id="line-68"><td class="table-line d-table"><a href="#line-68">68</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15,20&amp;h=HighlightJs&quot;</span>
</td></tr><tr id="line-69"><td class="table-line l-table"><a href="#line-69">69</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15,20&amp;h=HighlightRouge&quot;</span>
</td></tr><tr id="line-70"><td class="table-line d-table"><a href="#line-70"><strong>70</strong></a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15,20&amp;h=HighlightPygments&quot;</span>
</td></tr><tr id="line-71"><td class="table-line l-table"><a href="#line-71">71</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml;nolines;15&amp;h=HighlightPygmentsJython&quot;</span>
</td></tr><tr id="line-72"><td class="table-line d-table"><a href="#line-72">72</a></td><td class="code-line d-code"><span class="hljs-comment">	 *</span>
</td></tr><tr id="line-73"><td class="table-line l-table"><a href="#line-73">73</a></td><td class="code-line l-code"><span class="hljs-comment">	 * Create simple HTML page:</span>
</td></tr><tr id="line-74"><td class="table-line d-table"><a href="#line-74">74</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml&quot; &gt; page.html</span>
</td></tr><tr id="line-75"><td class="table-line l-table"><a href="#line-75">75</a></td><td class="code-line l-code"><span class="hljs-comment">	 * Another way:</span>
</td></tr><tr id="line-76"><td class="table-line d-table"><a href="#line-76">76</a></td><td class="code-line d-code"><span class="hljs-comment">	 *  $ CONTENT=`cat file.xml | curl --data-binary @- &quot;https://code.exlmoto.ru/api/?o=xml&quot;`</span>
</td></tr><tr id="line-77"><td class="table-line l-table"><a href="#line-77">77</a></td><td class="code-line l-code"><span class="hljs-comment">	 *  $ echo &quot;&lt;code class=&quot;hljs highlight&quot;&gt;&lt;pre&gt;$CONTENT&lt;/pre&gt;&lt;/code&gt;&quot; &gt; page.html</span>
</td></tr><tr id="line-78"><td class="table-line d-table"><a href="#line-78">78</a></td><td class="code-line d-code"><span class="hljs-comment">	 */</span>
</td></tr><tr id="line-79"><td class="table-line l-table"><a href="#line-79">79</a></td><td class="code-line l-code">	<span class="hljs-meta">@PostMapping(path = &quot;/api&quot;, produces = &quot;text/plain;charset=UTF-8&quot;)</span>
</td></tr><tr id="line-80"><td class="table-line d-table"><a href="#line-80"><strong>80</strong></a></td><td class="code-line d-code">	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">highlight</span><span class="hljs-params">(InputStream inputDataStream,</span></span>
</td></tr><tr id="line-81"><td class="table-line l-table"><a href="#line-81">81</a></td><td class="code-line l-code"><span class="hljs-function"><span class="hljs-params">	                        <span class="hljs-meta">@RequestParam(name = &quot;o&quot;, required = false, defaultValue = &quot;&quot;)</span> String options,</span></span>
</td></tr><tr id="line-82"><td class="table-line d-table"><a href="#line-82">82</a></td><td class="code-line d-code"><span class="hljs-function"><span class="hljs-params">	                        <span class="hljs-meta">@RequestParam(name = &quot;h&quot;, required = false, defaultValue = &quot;HighlightJs&quot;)</span> String mode)</span> </span>{
</td></tr><tr id="line-83"><td class="table-line l-table"><a href="#line-83">83</a></td><td class="code-line l-code">		Scanner scanner = <span class="hljs-keyword">new</span> Scanner(inputDataStream).useDelimiter(<span class="hljs-string">&quot;\\A&quot;</span>); <span class="hljs-comment">// https://stackoverflow.com/a/5445161</span>
</td></tr><tr id="line-84"><td class="table-line d-table"><a href="#line-84">84</a></td><td class="code-line d-code">		<span class="hljs-keyword">if</span> (scanner.hasNext()) {
</td></tr><tr id="line-85"><td class="table-line l-table"><a href="#line-85">85</a></td><td class="code-line l-code">			String code = scanner.next();
</td></tr><tr id="line-86"><td class="table-line d-table"><a href="#line-86">86</a></td><td class="code-line d-code">			<span class="hljs-keyword">if</span> (StringUtils.hasText(code) &amp;&amp; code.length() &lt; config.getSnippetMaxLength()) {
</td></tr><tr id="line-87"><td class="table-line l-table"><a href="#line-87">87</a></td><td class="code-line l-code">				<span class="hljs-keyword">return</span> highlight.highlightCode(Mode.getMode(mode), util.getCorrectOptions(options), code);
</td></tr><tr id="line-88"><td class="table-line d-table"><a href="#line-88">88</a></td><td class="code-line d-code">			}
</td></tr><tr id="line-89"><td class="table-line l-table"><a href="#line-89">89</a></td><td class="code-line l-code">		}
</td></tr><tr id="line-90"><td class="table-line d-table"><a href="#line-90"><strong>90</strong></a></td><td class="code-line d-code">		scanner.close();
</td></tr><tr id="line-91"><td class="table-line l-table"><a href="#line-91">91</a></td><td class="code-line l-code">		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error: Cannot highlight code snippet.&quot;</span>;
</td></tr><tr id="line-92"><td class="table-line d-table"><a href="#line-92">92</a></td><td class="code-line d-code">	}
</td></tr><tr id="line-93"><td class="table-line l-table"><a href="#line-93">93</a></td><td class="code-line l-code">
</td></tr><tr id="line-94"><td class="table-line d-table"><a href="#line-94">94</a></td><td class="code-line d-code">	<span class="hljs-comment">/*</span>
</td></tr><tr id="line-95"><td class="table-line l-table"><a href="#line-95">95</a></td><td class="code-line l-code"><span class="hljs-comment">	 * Highlight CSS usage examples:</span>
</td></tr><tr id="line-96"><td class="table-line d-table"><a href="#line-96">96</a></td><td class="code-line d-code"><span class="hljs-comment">	 * $ curl &quot;https://code.exlmoto.ru/api/css&quot;</span>
</td></tr><tr id="line-97"><td class="table-line l-table"><a href="#line-97">97</a></td><td class="code-line l-code"><span class="hljs-comment">	 * $ curl &quot;https://code.exlmoto.ru/api/css?skin=pastorg&quot;</span>
</td></tr><tr id="line-98"><td class="table-line d-table"><a href="#line-98">98</a></td><td class="code-line d-code"><span class="hljs-comment">	 * $ curl &quot;https://code.exlmoto.ru/api/css?skin=pastorg&amp;mode=HighlightRouge&quot;</span>
</td></tr><tr id="line-99"><td class="table-line l-table"><a href="#line-99">99</a></td><td class="code-line l-code"><span class="hljs-comment">	 * $ curl &quot;https://code.exlmoto.ru/api/css?skin=techno&amp;mode=HighlightPygments&quot;</span>
</td></tr><tr id="line-100"><td class="table-line d-table"><a href="#line-100"><strong>100</strong></a></td><td class="code-line d-code"><span class="hljs-comment">	 */</span>
</td></tr><tr id="line-101"><td class="table-line l-table"><a href="#line-101">101</a></td><td class="code-line l-code">	<span class="hljs-meta">@GetMapping(path = &quot;/api/css&quot;, produces = &quot;text/css;charset=UTF-8&quot;)</span>
</td></tr><tr id="line-102"><td class="table-line d-table"><a href="#line-102">102</a></td><td class="code-line d-code">	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">css</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(name = &quot;skin&quot;, required = false, defaultValue = &quot;techno&quot;)</span> String skin,</span></span>
</td></tr><tr id="line-103"><td class="table-line l-table"><a href="#line-103">103</a></td><td class="code-line l-code"><span class="hljs-function"><span class="hljs-params">	                  <span class="hljs-meta">@RequestParam(name = &quot;mode&quot;, required = false, defaultValue = &quot;HighlightJs&quot;)</span> String mode)</span> </span>{
</td></tr><tr id="line-104"><td class="table-line d-table"><a href="#line-104">104</a></td><td class="code-line d-code">		<span class="hljs-keyword">try</span> {
</td></tr><tr id="line-105"><td class="table-line l-table"><a href="#line-105">105</a></td><td class="code-line l-code">			<span class="hljs-keyword">return</span> resource.readFileToString(<span class="hljs-string">&quot;classpath:&quot;</span> + Mode.getCss(Mode.valueOf(mode), Skin.valueOf(skin)));
</td></tr><tr id="line-106"><td class="table-line d-table"><a href="#line-106">106</a></td><td class="code-line d-code">		} <span class="hljs-keyword">catch</span> (IllegalArgumentException | UncheckedIOException ignored) { }
</td></tr><tr id="line-107"><td class="table-line l-table"><a href="#line-107">107</a></td><td class="code-line l-code">		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error: Cannot get CSS from resources.&quot;</span>;
</td></tr><tr id="line-108"><td class="table-line d-table"><a href="#line-108">108</a></td><td class="code-line d-code">	}
</td></tr><tr id="line-109"><td class="table-line l-table"><a href="#line-109">109</a></td><td class="code-line l-code">
</td></tr><tr id="line-110"><td class="table-line d-table"><a href="#line-110"><strong>110</strong></a></td><td class="code-line d-code">	<span class="hljs-meta">@GetMapping(path = &quot;/api/versions&quot;, produces = &quot;application/json;charset=UTF-8&quot;)</span>
</td></tr><tr id="line-111"><td class="table-line l-table"><a href="#line-111">111</a></td><td class="code-line l-code">	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">versions</span><span class="hljs-params">()</span> </span>{
</td></tr><tr id="line-112"><td class="table-line d-table"><a href="#line-112">112</a></td><td class="code-line d-code">		<span class="hljs-keyword">final</span> ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();
</td></tr><tr id="line-113"><td class="table-line l-table"><a href="#line-113">113</a></td><td class="code-line l-code">		<span class="hljs-keyword">final</span> ObjectNode root = mapper.createObjectNode();
</td></tr><tr id="line-114"><td class="table-line d-table"><a href="#line-114">114</a></td><td class="code-line d-code">		highlight.getVersions().forEach((k, v) -&gt; {
</td></tr><tr id="line-115"><td class="table-line l-table"><a href="#line-115">115</a></td><td class="code-line l-code">			<span class="hljs-keyword">final</span> ObjectNode child = mapper.createObjectNode();
</td></tr><tr id="line-116"><td class="table-line d-table"><a href="#line-116">116</a></td><td class="code-line d-code">			child.put(<span class="hljs-string">&quot;language&quot;</span>, v.getFirst());
</td></tr><tr id="line-117"><td class="table-line l-table"><a href="#line-117">117</a></td><td class="code-line l-code">			child.put(<span class="hljs-string">&quot;library&quot;</span>, v.getSecond());
</td></tr><tr id="line-118"><td class="table-line d-table"><a href="#line-118">118</a></td><td class="code-line d-code">			root.set(k.name(), child);
</td></tr><tr id="line-119"><td class="table-line l-table"><a href="#line-119">119</a></td><td class="code-line l-code">		});
</td></tr><tr id="line-120"><td class="table-line d-table"><a href="#line-120"><strong>120</strong></a></td><td class="code-line d-code">		root.put(<span class="hljs-string">&quot;GraalVM&quot;</span>, highlight.getGraalVMVersion());
</td></tr><tr id="line-121"><td class="table-line l-table"><a href="#line-121">121</a></td><td class="code-line l-code">
</td></tr><tr id="line-122"><td class="table-line d-table"><a href="#line-122">122</a></td><td class="code-line d-code">		<span class="hljs-keyword">try</span> {
</td></tr><tr id="line-123"><td class="table-line l-table"><a href="#line-123">123</a></td><td class="code-line l-code">			<span class="hljs-keyword">return</span> mapper.writerWithDefaultPrettyPrinter().writeValueAsString(root);
</td></tr><tr id="line-124"><td class="table-line d-table"><a href="#line-124">124</a></td><td class="code-line d-code">		} <span class="hljs-keyword">catch</span> (JsonProcessingException jpe) {
</td></tr><tr id="line-125"><td class="table-line l-table"><a href="#line-125">125</a></td><td class="code-line l-code">			<span class="hljs-keyword">final</span> String error = String.format(<span class="hljs-string">&quot;Cannot generate JSON version information: &#x27;%s&#x27;.&quot;</span>, jpe.getMessage());
</td></tr><tr id="line-126"><td class="table-line d-table"><a href="#line-126">126</a></td><td class="code-line d-code">			log.error(error, jpe);
</td></tr><tr id="line-127"><td class="table-line l-table"><a href="#line-127">127</a></td><td class="code-line l-code">			<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;{ \&quot;error\&quot; : \&quot;&quot;</span> + error + <span class="hljs-string">&quot;\&quot; }&quot;</span>;
</td></tr><tr id="line-128"><td class="table-line d-table"><a href="#line-128">128</a></td><td class="code-line d-code">		}
</td></tr><tr id="line-129"><td class="table-line l-table"><a href="#line-129">129</a></td><td class="code-line l-code">	}
</td></tr><tr id="line-130"><td class="table-line d-table"><a href="#line-130"><strong>130</strong></a></td><td class="code-line d-code">}
</td></tr></table>